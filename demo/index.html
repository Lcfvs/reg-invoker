<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="description" content="A reg-invoker demo" />
        <title>A reg-invoker demo</title>
    </head>
    <body>
        <header>
            <h1>
               A reg-invoker demo
            </h1>
        </header>
        <section data-tpl-selector="section">
        <p></p>
        </section>
        <script src="reg-invoker.js"></script>
        <script>
var iframe,
    lib;

lib = regInvoker.invoke(function (instance, registry) {
    instance.writeName = function writeName() {
        document.querySelector('p').innerHTML += 'instance.name() : '
        + this.name()
        + '<br />';
    };
    
    instance.writeProtectedValue = function writeProtectedValue() {
        document.querySelector('p').innerHTML += 'registry.parent().get(\'protectedValue\', \'unknown\') : '
        + registry.parent().get('protectedValue', 'unknown')
        + '<br />';
    };
    
    if (!instance.parent()) {
        registry.init('protectedValue', 'a protected value');
    }
    
    return instance;
});

lib.writeName();

iframe = document.createElement('iframe');
iframe.src = 'iframe.html';

iframe.onload = function onload(){
    iframe.contentWindow.test(lib.fork('iframe'));
};

document.querySelector('section').appendChild(iframe);
        </script>
    </body>
</html>
