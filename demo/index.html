<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="description" content="A reg-invoker demo" />
        <title>A reg-invoker demo</title>
    </head>
    <body>
        <header>
            <h1>
               A reg-invoker demo
            </h1>
        </header>
        <section data-tpl-selector="section">
        <p></p>
        </section>
        <script src="https://raw.github.com/Lcfvs/reg-invoker/master/reg-invoker.min.js"></script>
        <script>
var iframe,
    lib;

lib = regInvoker.invoke(function (instance, registry) {
    var childName;
    
    if (!instance.parent()) {
        childName = 'iframe';
        registry.set('childName', childName);
    }

    instance.register = function () {
        document.querySelector('p').innerHTML += 'child.parent().getChildName() : '
        + this.parent().getChildName() // iframe
        + '<br />';
        
        document.querySelector('p').innerHTML += 'child.getChildName() : '
        + this.getChildName() // unknown
        + '<br />';
    };
    
    instance.getChildName = function () {
        return registry.get('childName', 'unknown');
    };
    
    return instance;
});
     
document.querySelector('p').innerHTML += 'lib.getChildName() : '
+ lib.getChildName() // iframe
+ '<br />';

iframe = document.createElement('iframe');
iframe.src = 'iframe.html';

iframe.onload = function onload(){
    iframe.contentWindow.test(lib.fork());
};

document.querySelector('section').appendChild(iframe);
        </script>
    </body>
</html>
